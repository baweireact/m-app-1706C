(function(t){function e(e){for(var o,i,u=e[0],c=e[1],s=e[2],d=0,m=[];d<u.length;d++)i=u[d],Object.prototype.hasOwnProperty.call(a,i)&&a[i]&&m.push(a[i][0]),a[i]=0;for(o in c)Object.prototype.hasOwnProperty.call(c,o)&&(t[o]=c[o]);l&&l(e);while(m.length)m.shift()();return r.push.apply(r,s||[]),n()}function n(){for(var t,e=0;e<r.length;e++){for(var n=r[e],o=!0,u=1;u<n.length;u++){var c=n[u];0!==a[c]&&(o=!1)}o&&(r.splice(e--,1),t=i(i.s=n[0]))}return t}var o={},a={app:0},r=[];function i(e){if(o[e])return o[e].exports;var n=o[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=t,i.c=o,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)i.d(n,o,function(e){return t[e]}.bind(null,o));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="/";var u=window["webpackJsonp"]=window["webpackJsonp"]||[],c=u.push.bind(u);u.push=e,u=u.slice();for(var s=0;s<u.length;s++)e(u[s]);var l=c;r.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"365c":function(t,e,n){"use strict";(function(t){n("96cf");var o=n("89ba"),a=n("bc3a"),r=n.n(a),i=n("4f8d");console.log(t),r.a.interceptors.request.use((function(t){return t})),r.a.interceptors.response.use((function(t){return 400===t.data.code&&alert(t.data.message),t}));var u=function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(e){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,r()(e);case 2:return n=t.sent,t.abrupt("return",n.data);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();e["a"]={login:function(t){return u({url:i["a"].login,data:t,method:"post"})},getNav:function(){return u({url:i["a"].getNav})},getList:function(t){return u({url:i["a"].getList+t})},updateMyBook:function(t){return u({url:i["a"].updateMyBook,data:t,method:"post"})},add:function(t){return u({url:i["a"].add,data:t,method:"post"})},getMyBook:function(){return u({url:i["a"].getMyBook})},getDetail:function(t){return u({url:i["a"].getDetail+t})}}}).call(this,n("4362"))},"4f8d":function(t,e,n){"use strict";var o={login:"/api/login",getNav:"/api/nav",getList:"/api/list",updateMyBook:"/api/update_my_book",add:"/api/add",getMyBook:"/api/get_my_book",getDetail:"/api/detail"};e["a"]=o},"56d7":function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var o=n("2b0e"),a=n("caf9"),r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("router-view")],1)},i=[],u=n("2877"),c={},s=Object(u["a"])(c,r,i,!1,null,null,null),l=s.exports,d=n("8c4f"),m=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("div",[n("input",{directives:[{name:"model",rawName:"v-model",value:t.username,expression:"username"}],ref:"username",attrs:{placeholder:"请输入用户名"},domProps:{value:t.username},on:{input:function(e){e.target.composing||(t.username=e.target.value)}}})]),n("div",[n("input",{directives:[{name:"model",rawName:"v-model",value:t.password,expression:"password"}],attrs:{placeholder:"请输入密码",type:"password"},domProps:{value:t.password},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.handleLogin()},input:function(e){e.target.composing||(t.password=e.target.value)}}})]),n("button",{on:{click:function(e){return t.handleLogin()}}},[t._v("登录")])])},h=[],f=(n("bc3a"),n("365c")),p={data:function(){return{username:"admin",password:"123456"}},methods:{handleLogin:function(){var t=this;f["a"].login({username:this.username,password:this.password}).then((function(e){200===e.code&&(localStorage.setItem("username",e.data.username),t.$router.push("/index/home"))}))}},mounted:function(){this.$refs.username.focus()}},v=p,y=Object(u["a"])(v,m,h,!1,null,null,null),k=y.exports,g=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("div",[n("router-link",{staticClass:"m-nav-item",attrs:{to:"/index/home"}},[t._v("首页")]),n("router-link",{staticClass:"m-nav-item",attrs:{to:"/index/my_book"}},[t._v("书包")])],1),t.username?n("div",{staticClass:"m-user"},[t._v("用户名:"+t._s(t.username)+" "),n("button",{on:{click:function(e){return t.handleQuit()}}},[t._v("退出")])]):n("div",{staticClass:"m-user"},[n("button",{on:{click:function(e){return t.handleLogin()}}},[t._v("登录")])]),n("router-view")],1)},_=[],b={data:function(){return{username:""}},methods:{handleQuit:function(){localStorage.removeItem("username"),this.username=""},handleLogin:function(){this.$router.push("/login")}},mounted:function(){this.username=localStorage.getItem("username")}},B=b,$=Object(u["a"])(B,g,_,!1,null,null,null),w=$.exports,x=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("Nav"),n("List")],1)},L=[],S=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",t._l(t.navList,(function(e){return n("span",{key:e.id,staticClass:"m-nav-item",class:{active:t.currentId===e.id},on:{click:function(n){return t.handleNav(e.id)}}},[t._v(t._s(e.title))])})),0)},O=[],j={computed:{navList:function(){return this.$store.state.navList},currentId:function(){return this.$store.state.currentId}},methods:{handleNav:function(t){this.$store.commit({type:"setState",key:"currentId",value:t}),this.$store.dispatch({type:"getList",id:t})}}},M=j,C=Object(u["a"])(M,S,O,!1,null,null,null),N=C.exports,P=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",t._l(t.currentList,(function(e){return n("div",{key:e.id,staticClass:"m-list-item"},[n("div",{staticClass:"m-list-item-img-wrap"},[n("img",{directives:[{name:"lazy",rawName:"v-lazy",value:e.avatar,expression:"item.avatar"}],staticClass:"m-list-item-img",attrs:{alt:""}})]),n("div",{staticClass:"m-list-item-info"},[n("div",[t._v(t._s(e.title))]),n("div",[n("button",{on:{click:function(n){return t.handleDetail(e.id)}}},[t._v("详情")]),e.is_in_my_book?n("button",[t._v("已收藏")]):n("button",{on:{click:function(n){return t.handleAdd(e)}}},[t._v("收藏")])])])])})),0)},A=[],E={computed:{currentList:function(){return this.$store.state.currentList}},methods:{handleAdd:function(t){var e=this;localStorage.getItem("username")||this.$router.push("/login"),t.count=1,t.checked=!0,f["a"].add({book:t}).then((function(t){200===t.code&&e.$store.dispatch({type:"getList"})}))},handleDetail:function(t){this.$router.push("/detail/".concat(t))}}},I=E,D=Object(u["a"])(I,P,A,!1,null,null,null),T=D.exports,z={components:{Nav:N,List:T},mounted:function(){this.$store.dispatch({type:"getNav"}),this.$store.dispatch({type:"getList"})}},J=z,Q=Object(u["a"])(J,x,L,!1,null,null,null),R=Q.exports,q=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t._l(t.myBook,(function(e,o){return n("div",{key:e.id},[n("input",{attrs:{type:"checkbox",id:e.id},domProps:{checked:e.checked},on:{change:function(e){return t.handleChecked(o,e)}}}),n("label",{attrs:{for:e.id}},[t._v(t._s(e.title))]),t._v(" ,￥"+t._s(e.price)+" "),n("button",{on:{click:function(e){return t.handleSub(o)}}},[t._v("-")]),t._v(" "),n("span",[t._v(t._s(e.count))]),t._v(" "),n("button",{on:{click:function(e){return t.handleAdd(o)}}},[t._v("+")]),n("button",{on:{click:function(e){return t.handleDelete(o)}}},[t._v("删除")])])})),n("div",[n("input",{attrs:{type:"checkbox",id:"m-select-all"},domProps:{checked:t.total.selectAll},on:{change:function(e){return t.handleSelectAll(e)}}}),n("label",{attrs:{for:"m-select-all"}},[t._v("全选")]),t._v(" "),n("button",{on:{click:function(e){return t.handleDeleteAll()}}},[t._v("删除")])]),n("div",[t._v(" 总价：￥"+t._s(t.total.totalPrice)+"，总数："+t._s(t.total.totalCount)+" ")])],2)},F=[],G=(n("4de4"),n("4160"),n("a434"),n("159b"),{computed:{myBook:function(){return this.$store.state.myBook},total:function(){var t=this.$store.state.myBook,e=0,n=0;return t.filter((function(t){return t.checked})).forEach((function(t){n+=t.count,e+=t.count*t.price})),{totalPrice:e,totalCount:n,selectAll:t.filter((function(t){return t.checked})).length===t.length}}},methods:{handleDelete:function(t){this.myBook.splice(t,1),this.$store.commit({type:"setState",key:"myBook",value:this.myBook})},handleDeleteAll:function(){var t=this.myBook.filter((function(t){return!t.checked}));this.$store.commit({type:"setState",key:"myBook",value:t})},handleAdd:function(t){this.myBook[t].count+=1,this.$store.commit({type:"setState",key:"myBook",value:this.myBook})},handleSub:function(t){this.myBook[t].count>1&&(this.myBook[t].count-=1,this.$store.commit({type:"setState",key:"myBook",value:this.myBook}))},handleChecked:function(t,e){this.myBook[t].checked=e.target.checked,this.$store.commit({type:"setState",key:"myBook",value:this.myBook})},handleSelectAll:function(t){this.myBook.forEach((function(e){e.checked=t.target.checked})),this.$store.commit({type:"setState",key:"myBook",value:this.myBook})}},updated:function(){this.$store.dispatch({type:"updateMyBook",myBook:this.myBook})},mounted:function(){this.$store.dispatch({type:"getMyBook"})}}),H=G,K=Object(u["a"])(H,q,F,!1,null,null,null),U=K.exports,V=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("img",{attrs:{src:t.detail.avatar,alt:""}}),n("div",[t.detail.is_in_my_book?n("button",[t._v("已收藏")]):n("button",{on:{click:function(e){return t.handleAdd(t.detail)}}},[t._v("收藏")])]),n("div",[t._v(t._s(t.detail.summary))])])},W=[],X={data:function(){return{detail:{}}},methods:{handleAdd:function(t){var e=this;localStorage.getItem("username")||this.$router.push("/login"),t.count=1,t.checked=!0,f["a"].add({book:t}).then((function(t){200===t.code&&(e.detail.is_in_my_book=!0)}))}},mounted:function(){var t=this,e=this.$route.params.id;f["a"].getDetail("?id=".concat(e)).then((function(e){200===e.code&&(t.detail=e.data)}))}},Y=X,Z=Object(u["a"])(Y,V,W,!1,null,null,null),tt=Z.exports;o["a"].use(d["a"]);var et=[{path:"/",redirect:"/login"},{path:"/login",component:k},{path:"/index",component:w,children:[{path:"/index/home",component:R},{path:"/index/my_book",component:U,meta:{needLogin:!0}},{path:"/detail/:id",component:tt}]}],nt=new d["a"]({mode:"history",base:"/",routes:et});nt.beforeEach((function(t,e,n){t.meta.needLogin?localStorage.getItem("username")?n():n("/login"):n()}));var ot=nt,at=n("207f"),rt=n("2f62");o["a"].use(rt["a"]);var it=new rt["a"].Store({state:{navList:[],currentList:[],currentId:0,myBook:[]},mutations:{setState:function(t,e){t[e.key]=e.value}},actions:{getNav:function(t){var e=t.commit;f["a"].getNav().then((function(t){200===t.code&&e({type:"setState",key:"navList",value:t.data})}))},getList:function(t){var e=t.commit,n=t.state;f["a"].getList("?id=".concat(n.currentId)).then((function(t){200===t.code&&e({type:"setState",key:"currentList",value:t.data})}))},updateMyBook:function(t,e){Object(at["a"])(t),f["a"].updateMyBook({myBookNew:e.myBook}).then((function(t){t.code}))},getMyBook:function(t){var e=t.commit;f["a"].getMyBook().then((function(t){200===t.code&&e({type:"setState",key:"myBook",value:t.data})}))}},modules:{}}),ut=(n("a766"),n("ef03")),ct=n.n(ut);o["a"].config.productionTip=!1,o["a"].use(a["a"],{preLoad:1.3,error:ct.a,loading:ct.a,attempt:1}),new o["a"]({router:ot,store:it,render:function(t){return t(l)}}).$mount("#app")},a766:function(t,e,n){},ef03:function(t,e,n){t.exports=n.p+"img/loading.01096fe5.gif"}});
//# sourceMappingURL=app.013e7300.js.map